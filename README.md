# Модели машинного обучения и методы их интерпретации для анализа данных пациентов на наличие метаболических нарушений. 

## Суть работы

Данная работа посвящена анализу данных фактического питания и показателей антропометрии пациентов для диагностирования метаболического синдрома (МС) с применением методов машинного обучения. В работе представлены особенности анализа классическими методами машинного обучения, процедуры интерпретации результатов, а также сравнительная оценка эффективности каждого из методов анализа. Из полученных результатов следует, что алгоритм машинного обучения XGBRFClassifier демонстрирует лучший результат в предсказании диагноза в сравнении с другими моделями. Выявлены параметры оказывающие значительное влияние на качество предсказания. 

## Цели и задачи

Основной целью работы является разработка методики, помогающей определить наличие метаболического синдрома у пациентов и основанной на предсказании модели машинного обучения и учета особо важных показателей питания.

Задачи:
1. Предобработать общий массив данных и выделить наиболее значимые признаки у пациентов
2. Подобрать наиболее оптимальную модель, с точки зрения качества предсказания, затрачиваемых ресурсов и интерпретируемости 
3. Сравнить полученный результат с общепринятыми медицинскими практиками

## Данные

Данные представляют собой датасет из 2885 строк (по строке на пациента), по каждому пациенту собирались данные по анамнезу питания, биохимии крови и антропометрическим параметрам. Общее количество признаков составило 75, из которых 66 описывают нутриентный состав фактической диеты, а 9 связаны с антропометрией и прочими данными о пациенте. Диагнозы, связанные с наличием метаболического синдрома, были размечены как 1 (позитивный класс), люди без диагноза были размечены как 0 (негативный класс). Баланс классов в наборе данных (отношение количества здоровых пациентов к тем, у кого присутствовал диагноз, связанный с метаболическим синдромом) составил 1872 / 1013 (~ 65% / 35%). Все данные были приведены к численным значениям при помощи алгоритма One Hot Encoding и нормированы. В данных присутствовали пропуски, поскольку собрать полный набор параметров по каждому пациенту – это крайне проблематичная задача.

## Методология

Исследование проводилось преимущественно с использованием классических методов машинного обучения, поскольку они обладают хорошей интерпретируемостью и работают с табличными данными чаще лучше, чем нейросетевые подходы. Для анализа были использованы следующие модели:
1. Random Forest (Classic RF, XGBRFClassifier)
2. Boosting  (CatBoost, XGBoost, LightGBM)
3. LightAutoML

## Структура репозитория

- **data** — папка с .csv файлами, в которых находятся **примеры** тренировочной, валидационной и тестовой выборок, данные выборок не яляются полными
- **examples** — папка с результатами работы моделей, а именно метрик каждой модели на разных наборах данных и результаты отбора признаков различными алгоритмами
- **weights** — папка с весами обученных моделей для случаев анализа на различных наборах признаков
- **src** — папка, в которой привдены функции для работы с данными, каждая функция имеет описание  
- **notebooks** — папка с Colab-блокнотами, основная часть работы проводилась непосредтвенно в них, поэтому по данным блокнотам можно получить наиболее полное представление о работе, каждый блокнот соответствует работе с различным набором признаков
- **requirements.txt** — файл с перечислением всех пакетов, необходимых для работы с проектом, и их версий

